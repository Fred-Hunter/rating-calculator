{"version":3,"file":"bundle.js","mappings":";;;;;;;;;AAAA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA8B,uCAAuC;AACrE,aAAa;AACb,SAAS;;AAET;AACA;;AAEA;AACA;AACA;AACA,aAAa;;AAEb;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,iDAAiD,OAAO;AACxD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,oDAAoD,MAAM;AAC1D;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oDAAoD,MAAM;AAC1D;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kDAAkD,QAAQ;AAC1D;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wCAAwC,MAAM;AAC9C;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC,eAAe,iBAAiB;AAChC,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,QAAQ;AACzB,iBAAiB,QAAQ;AACzB,iBAAiB,QAAQ;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,MAAM;AACzD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,MAAM;AAC1C;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;;AAEA,oCAAoC,QAAQ;AAC5C;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,SAAS;AACjD;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;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","sources":["webpack:///./node_modules/glicko2/glicko2.js","webpack:///webpack/bootstrap","webpack:///./script.js"],"sourcesContent":["(function(exports){\n    var scalingFactor = 173.7178;\n\n    function Race(results){\n        this.matches = this.computeMatches(results);\n    }\n    Race.prototype.getMatches = function(){\n        return this.matches;\n    };\n    Race.prototype.computeMatches = function(results){\n        var players = [];\n        var position = 0;\n\n        results.forEach(function (rank) {\n            position += 1;\n            rank.forEach(function (player) {\n                players.push({\"player\": player, \"position\": position});\n            })\n        })\n\n        function computeMatches(players){\n            if (players.length === 0) return [];\n\n            var player1 = players.shift()\n            var player1_results  = players.map(function(player2){\n                return [player1.player, player2.player, (player1.position < player2.position) ? 1 : 0.5];\n            });\n\n            return player1_results.concat(computeMatches(players));\n        }\n\n        return computeMatches(players)\n    }\n\n    function Player(rating, rd, vol, tau, default_rating, volatility_algorithm, id) {\n        this._tau = tau; \n        this.defaultRating = default_rating;\n        this.volatility_algorithm = volatility_algorithm;\n\n        this.setRating(rating);\n        this.setRd(rd);\n        this.setVol(vol);\n\n        this.id = id\n        this.adv_ranks = [];\n        this.adv_rds = [];\n        this.outcomes = [];\n    }\n\n    Player.prototype.getRating = function (){\n        return this.__rating * scalingFactor + this.defaultRating;\n    };\n\n    Player.prototype.setRating = function (rating){\n        this.__rating = (rating - this.defaultRating) / scalingFactor;\n    };\n\n    Player.prototype.getRd = function(){\n        return this.__rd * scalingFactor;\n    };\n\n    Player.prototype.setRd = function(rd){\n        this.__rd = rd / scalingFactor;\n    };\n\n    Player.prototype.getVol = function(){\n        return this.__vol;\n    };\n\n    Player.prototype.setVol = function(vol){\n        this.__vol = vol;\n    };\n\n    Player.prototype.addResult = function(opponent, outcome){\n        this.adv_ranks.push(opponent.__rating);\n        this.adv_rds.push(opponent.__rd);\n        this.outcomes.push(outcome);\n    };\n\n    // Calculates the new rating and rating deviation of the player.\n    // Follows the steps of the algorithm described at http://www.glicko.net/glicko/glicko2.pdf\n    Player.prototype.update_rank = function(){\n        if (!this.hasPlayed()){\n            // Applies only the Step 6 of the algorithm\n            this._preRatingRD();\n            return;\n        }\n\n        //Step 1 : done by Player initialization\n        //Step 2 : done by setRating and setRd\n\n        //Step 3\n        var v = this._variance();\n\n        //Step 4\n        var delta = this._delta(v);\n\n        //Step 5\n        this.__vol = this.volatility_algorithm(v, delta);\n\n        //Step 6\n        this._preRatingRD();\n\n        //Step 7\n        this.__rd = 1 / Math.sqrt((1 / Math.pow(this.__rd, 2)) + (1 / v));\n\n        var tempSum = 0;\n        for (var i=0,len = this.adv_ranks.length;i< len;i++){\n            tempSum += this._g(this.adv_rds[i]) * (this.outcomes[i] - this._E(this.adv_ranks[i], this.adv_rds[i]));\n        }\n        this.__rating += Math.pow(this.__rd, 2) * tempSum;\n\n        //Step 8 : done by getRating and getRd\n    };\n\n    Player.prototype.hasPlayed = function(){\n        return this.outcomes.length > 0;\n    };\n\n    // Calculates and updates the player's rating deviation for the beginning of a rating period.\n    // preRatingRD() -> None\n    Player.prototype._preRatingRD = function(){\n        this.__rd = Math.sqrt(Math.pow(this.__rd, 2) + Math.pow(this.__vol, 2));\n    };\n\n\n    // Calculation of the estimated variance of the player's rating based on game outcomes\n    Player.prototype._variance = function (){\n        var tempSum = 0;\n        for (var i = 0, len = this.adv_ranks.length;i<len;i++){\n            var tempE = this._E(this.adv_ranks[i], this.adv_rds[i]);\n            tempSum += Math.pow(this._g(this.adv_rds[i]), 2) * tempE * (1 - tempE);\n        }\n        return 1 / tempSum;\n    };\n\n    // The Glicko E function.\n    Player.prototype._E = function (p2rating, p2RD){\n        return 1 / (1 + Math.exp(-1 * this._g(p2RD) *  (this.__rating - p2rating)));\n    };\n\n    // The Glicko2 g(RD) function.\n    Player.prototype._g = function(RD){\n        return 1 / Math.sqrt(1 + 3 * Math.pow(RD, 2) / Math.pow(Math.PI, 2));\n    };\n\n    // The delta function of the Glicko2 system.\n    // Calculation of the estimated improvement in rating (step 4 of the algorithm)\n    Player.prototype._delta = function(v){\n        var tempSum = 0;\n        for (var i = 0, len = this.adv_ranks.length;i<len;i++){\n            tempSum += this._g(this.adv_rds[i]) * (this.outcomes[i] - this._E(this.adv_ranks[i], this.adv_rds[i]));\n        }\n        return v * tempSum;\n    };\n\n    Player.prototype._makef = function(delta, v, a){\n        var pl = this;\n        return function(x){\n            return Math.exp(x) * (Math.pow(delta, 2) - Math.pow(pl.__rd, 2) - v - Math.exp(x)) / (2*Math.pow(Math.pow(pl.__rd, 2) + v + Math.exp(x), 2)) - (x - a) / Math.pow(pl._tau, 2);\n        };\n    };\n\n    //=========================  Glicko2 class =============================================\n    function Glicko2(settings){\n        settings = settings || {};\n\n        // Internal glicko2 parameter. \"Reasonable choices are between 0.3 and\n        // 1.2, though the system should be tested to decide which value results\n        // in greatest predictive accuracy.\"\n        this._tau = settings.tau || 0.5;\n\n        // Default rating\n        this._default_rating = settings.rating || 1500;\n\n        // Default rating deviation (small number = good confidence on the\n        // rating accuracy)\n        this._default_rd = settings.rd || 350;\n\n        // Default volatility (expected fluctation on the player rating)\n        this._default_vol = settings.vol || 0.06;\n\n        // Default volatility calculation algorithm (step 5 of the global\n        // algorithm)\n        this._volatility_algorithm = volatility_algorithms[settings.volatility_algorithm || 'newprocedure'];\n\n        this.players = [];\n        this.players_index = 0;\n    }\n\n    Glicko2.prototype.makeRace = function(results){\n        return new Race(results);\n    };\n\n    Glicko2.prototype.removePlayers = function() {\n        this.players = [];\n        this.players_index = 0;\n    };\n\n    Glicko2.prototype.getPlayers = function(){\n        return this.players;\n    };\n\n    Glicko2.prototype.cleanPreviousMatches = function(){\n        for (var i = 0, len = this.players.length;i < len;i++){\n            this.players[i].adv_ranks = [];\n            this.players[i].adv_rds = [];\n            this.players[i].outcomes = [];\n        }\n    };\n\n    Glicko2.prototype.calculatePlayersRatings = function(){\n        var keys = Object.keys(this.players);\n        for (var i=0, len = keys.length;i<len;i++){\n            this.players[keys[i]].update_rank();\n        }\n    };\n\n    /** \n     * Add players and match result to be taken in account for the new rankings calculation\n     * players must have ids, they are not created if it has been done already.\n     * @param {Object litteral} pl1 The first player\n     * @param {Object litteral} pl2 The second player\n     * @param {number} outcom The outcome : 0 = defeat, 1 = victory, 0.5 = draw\n     */\n      Glicko2.prototype.addMatch = function(player1, player2, outcome){\n          var pl1 = this._createInternalPlayer(player1.rating, player1.rd, player1.vol, player1.id);\n          var pl2 = this._createInternalPlayer(player2.rating, player2.rd, player2.vol, player2.id);\n          this.addResult(pl1, pl2, outcome);\n          return {pl1:pl1, pl2:pl2};\n      };\n\n      Glicko2.prototype.makePlayer = function (rating, rd , vol) {\n          //We do not expose directly createInternalPlayer in order to prevent the assignation of a custom player id whose uniqueness could not be guaranteed\n          return this._createInternalPlayer(rating, rd, vol);\n      };\n\n      Glicko2.prototype._createInternalPlayer = function (rating, rd , vol, id){\n          if (id === undefined){\n              id = this.players_index;\n              this.players_index = this.players_index + 1;\n          } else {\n              //We check if the player has already been created\n              var candidate = this.players[id];\n              if (candidate !== undefined){\n                  return candidate;\n              }\n          }\n          var player = new Player(rating || this._default_rating, rd || this._default_rd, vol || this._default_vol,\n                                  this._tau, this._default_rating, this._volatility_algorithm, id);\n\n          this.players[id] = player;\n          return player;\n      };\n\n      /** \n       * Add a match result to be taken in account for the new rankings calculation\n       * @param {Player} player1 The first player\n       * @param {Player} player2 The second player\n       * @param {number} outcome The outcome : 0 = defeat, 1 = victory, 0.5 = draw\n       */\n        Glicko2.prototype.addResult = function(player1, player2, outcome){\n            player1.addResult(player2, outcome);\n            player2.addResult(player1, 1 - outcome);\n        };\n\n        Glicko2.prototype.updateRatings = function(matches){\n            if(matches instanceof Race){\n                matches = matches.getMatches();\n            }\n            if (typeof(matches) !== 'undefined'){\n                this.cleanPreviousMatches();\n                for (var i=0, len = matches.length;i<len;i++){\n                    var match = matches[i];\n                    this.addResult(match[0], match[1], match[2]);\n                }\n            }\n            this.calculatePlayersRatings();\n        };\n\n        //============== VOLATILITY ALGORITHMS (Step 5 of the global glicko2 algorithm)\n        var volatility_algorithms = {\n            oldprocedure: function(v, delta) {\n                var sigma = this.__vol;\n                var phi = this.__rd;\n                var tau = this._tau;\n\n                var a, x1, x2, x3, y1, y2, y3, upper;\n                var result;\n\n                upper = find_upper_falsep(phi, v, delta, tau);\n\n                a = Math.log(Math.pow(sigma, 2));\n                y1 = equation(phi, v, 0, a, tau, delta);\n                if (y1 > 0 ){\n                    result = upper;\n                } else {\n                    x1 = 0;\n                    x2 = x1;\n                    y2 = y1;\n                    x1 = x1 - 1;\n                    y1 = equation(phi, v, x1, a, tau, delta);\n                    while (y1 < 0){\n                        x2 = x1;\n                        y2 = y1;\n                        x1 = x1 - 1;\n                        y1 = equation(phi, v, x1, a, tau, delta);\n                    }\n                    for (var i = 0; i<21; i++){\n                        x3 = y1 * (x1 - x2) / (y2 - y1) + x1;\n                        y3 = equation(phi, v, x3, a, tau, delta);\n                        if (y3 > 0 ){\n                            x1 = x3;\n                            y1 = y3;\n                        } else {\n                            x2 = x3;\n                            y2 = y3;\n                        }\n                    }\n                    if (Math.exp((y1 * (x1 - x2) / (y2 - y1) + x1) / 2) > upper ){\n                        result = upper;\n                    } else {\n                        result = Math.exp((y1 * (x1 - x2) / (y2 - y1) + x1) / 2);\n                    }\n                }\n                return result;\n\n                //\n                function new_sigma(sigma , phi , v , delta , tau ) {\n                    var a = Math.log(Math.pow(sigma, 2));\n                    var x = a;\n                    var old_x = 0;\n                    while (x != old_x){\n                        old_x = x;\n                        var d = Math.pow(phi, 2) + v + Math.exp(old_x);\n                        var h1 = -(old_x - a) / Math.pow(tau, 2) - 0.5 * Math.exp(old_x) / d + 0.5 * Math.exp(old_x) * Math.pow((delta / d), 2);\n                        var h2 = -1 / Math.pow(tau, 2) - 0.5 * Math.exp(old_x) * (Math.pow(phi, 2) + v) / Math.pow(d, 2) + 0.5 * Math.pow(delta, 2) * Math.exp(old_x) * (Math.pow(phi, 2) + v - Math.exp(old_x)) / Math.pow(d, 3);\n                        x = old_x - h1 / h2;\n                    }\n                    return  Math.exp(x / 2);\n                }\n\n                function equation(phi , v , x , a , tau , delta) {\n                    var d = Math.pow(phi, 2) + v + Math.exp(x);\n                    return -(x - a) / Math.pow(tau, 2) - 0.5 * Math.exp(x) / d + 0.5 * Math.exp(x) * Math.pow((delta / d), 2);\n                }\n\n                function new_sigma_bisection(sigma , phi , v , delta , tau ) {\n                    var a, x1, x2, x3;\n                    a = Math.log(Math.pow(sigma, 2));\n                    if (equation(phi, v, 0, a, tau, delta) < 0 ){\n                        x1 = -1;\n                        while (equation(phi, v, x1, a, tau, delta) < 0){\n                            x1 = x1 - 1;\n                        }\n                        x2 = x1 + 1;\n                    } else {\n                        x2 = 1;\n                        while (equation(phi, v, x2, a, tau, delta) > 0){\n                            x2 = x2 + 1;\n                        }\n                        x1 = x2 - 1;\n                    }\n\n                    for (var i = 0; i < 27; i++) {\n                        x3 = (x1 + x2) / 2;\n                        if (equation(phi, v, x3, a, tau, delta) > 0 ){\n                            x1 = x3;\n                        } else {\n                            x2 = x3;\n                        }\n                    }\n                    return  Math.exp((x1 + x2)/ 4);\n                }\n\n                function Dequation(phi , v , x , tau , delta) {\n                    d = Math.pow(phi, 2) + v + Math.exp(x);\n                    return -1 / Math.pow(tau, 2) - 0.5 * Math.exp(x) / d + 0.5 * Math.exp(x) * (Math.exp(x) + Math.pow(delta, 2)) / Math.pow(d, 2) - Math.pow(Math.exp(x), 2) * Math.pow(delta, 2) / Math.pow(d, 3);\n                }\n\n                function find_upper_falsep(phi , v , delta , tau) {\n                    var x1, x2, x3, y1, y2, y3;\n                    y1 = Dequation(phi, v, 0, tau, delta);\n                    if (y1 < 0 ){\n                        return 1;\n                    } else {\n                        x1 = 0;\n                        x2 = x1;\n                        y2 = y1;\n                        x1 = x1 - 1;\n                        y1 = Dequation(phi, v, x1, tau, delta);\n                        while (y1 > 0){\n                            x2 = x1;\n                            y2 = y1;\n                            x1 = x1 - 1;\n                            y1 = Dequation(phi, v, x1, tau, delta);\n                        }\n                        for (var i = 0; i < 21 ; i++){\n                            x3 = y1 * (x1 - x2) / (y2 - y1) + x1;\n                            y3 = Dequation(phi, v, x3, tau, delta);\n                            if (y3 > 0 ){\n                                x1 = x3;\n                                y1 = y3;\n                            } else {\n                                x2 = x3;\n                                y2 = y3;\n                            }\n                        }\n                        return Math.exp((y1 * (x1 - x2) / (y2 - y1) + x1) / 2);\n                    }\n                }\n            },\n            newprocedure: function(v, delta){\n                //Step 5.1\n                var A = Math.log(Math.pow(this.__vol, 2));\n                var f = this._makef(delta, v, A);\n                var epsilon = 0.0000001;\n\n                //Step 5.2\n                var B, k;\n                if (Math.pow(delta, 2) >  Math.pow(this.__rd, 2) + v){\n                    B = Math.log(Math.pow(delta, 2) -  Math.pow(this.__rd, 2) - v);\n                } else {\n                    k = 1;\n                    while (f(A - k * this._tau) < 0){\n                        k = k + 1;\n                    }\n                    B = A - k * this._tau;\n                }\n\n                //Step 5.3\n                var fA = f(A);\n                var fB = f(B);\n\n                //Step 5.4\n                var C, fC;\n                while (Math.abs(B - A) > epsilon){\n                    C = A + (A - B) * fA /(fB - fA );\n                    fC = f(C);\n                    if (fC * fB < 0){\n                        A = B;\n                        fA = fB;\n                    } else {\n                        fA = fA / 2;\n                    }\n                    B = C;\n                    fB = fC;\n                }\n                //Step 5.5\n                return Math.exp(A/2);\n            },\n            newprocedure_mod: function(v, delta){\n                //Step 5.1\n                var A = Math.log(Math.pow(this.__vol, 2));\n                var f = this._makef(delta, v, A);\n                var epsilon = 0.0000001;\n\n                //Step 5.2\n                var B, k;\n                //XXX mod\n                if (delta >  Math.pow(this.__rd, 2) + v){\n                    //XXX mod\n                    B = Math.log(delta -  Math.pow(this.__rd, 2) - v);\n                } else {\n                    k = 1;\n                    while (f(A - k * this._tau) < 0){\n                        k = k + 1;\n                    }\n                    B = A - k * this._tau;\n                }\n\n                //Step 5.3\n                var fA = f(A);\n                var fB = f(B);\n\n                //Step 5.4\n                var C, fC;\n                while (Math.abs(B - A) > epsilon){\n                    C = A + (A - B) * fA /(fB - fA );\n                    fC = f(C);\n                    if (fC * fB < 0){\n                        A = B;\n                        fA = fB;\n                    } else {\n                        fA = fA / 2;\n                    }\n                    B = C;\n                    fB = fC;\n                }\n                //Step 5.5\n                return Math.exp(A/2);\n            },\n            oldprocedure_simple: function(v, delta){\n                var i = 0;\n                var a = Math.log(Math.pow(this.__vol, 2));\n                var tau = this._tau;\n                var x0 = a;\n                var x1 = 0;\n                var d,h1,h2;\n\n                while (Math.abs(x0 - x1) > 0.00000001){\n                    // New iteration, so x(i) becomes x(i-1)\n                    x0 = x1;\n                    d = Math.pow(this.__rating, 2) + v + Math.exp(x0);\n                    h1 = -(x0 - a) / Math.pow(tau, 2) - 0.5 * Math.exp(x0) / d + 0.5 * Math.exp(x0) * Math.pow(delta / d, 2);\n                    h2 = -1 / Math.pow(tau, 2) - 0.5 * Math.exp(x0) * (Math.pow(this.__rating, 2) + v) / Math.pow(d, 2) + 0.5 * Math.pow(delta, 2) * Math.exp(x0) * (Math.pow(this.__rating, 2) + v - Math.exp(x0)) / Math.pow(d, 3);\n                    x1 = x0 - (h1 / h2);\n                }\n\n                return Math.exp(x1 / 2);\n            }\n        };\n        //==== End of volatility algorithms\n\n        exports.Glicko2 = Glicko2;\n\n    })(typeof exports === 'undefined'? this['glicko2']={}: exports);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const Glicko2 = require(\"glicko2\").Glicko2;\r\n\r\nconst settings = {\r\n\ttau: 0.5,\r\n\trpd: 604800,\r\n\trating: 1500,\r\n\trd: 300,\r\n\tvol: 0.06,\r\n};\r\nconst glicko = new Glicko2(settings);\r\n\r\nconst players = [];\r\n\r\nconst getPlayer = (name) => players.find((p) => p.name === name).glicko;\r\n\r\nwindow.onload = (e) => {\r\n    addEventListeners();\r\n};\r\n\r\nfunction showRankings() {\r\n\t// Sort players\r\n\tplayers.sort((pl1, pl2) => pl2.glicko.getRating() - pl1.glicko.getRating());\r\n\r\n\t// Get rankings div and clear its content\r\n\tconst rankingsDiv = document.getElementById(\"rankings\");\r\n\trankingsDiv.innerHTML = \"\";\r\n\r\n\t// Create and append the title\r\n\tconst title = document.createElement(\"h3\");\r\n\ttitle.textContent = \"Rankings\";\r\n\trankingsDiv.appendChild(title);\r\n\r\n\t// Create and append the list\r\n\tconst list = document.createElement(\"ul\");\r\n\tplayers.forEach((player) => {\r\n\t\tconst listItem = document.createElement(\"li\");\r\n\t\tconst rating = player.glicko.getRating().toFixed(1);\r\n\t\tconst deviation = player.glicko.getRd().toFixed(1);\r\n\t\tlistItem.textContent = `${player.name}: ${rating} (rd: ${deviation})`;\r\n\t\tlist.appendChild(listItem);\r\n\t});\r\n\trankingsDiv.appendChild(list);\r\n\r\n\t// Ensure the rankings section is visible\r\n\trankingsDiv.style.display = \"block\";\r\n}\r\n\r\nfunction createMatches(event) {\r\n    if (event) event.preventDefault(); // Prevent the default form submission behavior\r\n\r\n    // Get the selected separator\r\n    const separator = document.getElementById(\"separator\").value;\r\n\r\n    // Get and parse the table input\r\n    let table = document.getElementById(\"tableInput\").value;\r\n    table = table.split(\"\\n\");\r\n    table = table.map((r) => r.split(separator));\r\n\r\n    const defaultWeek = \"1\";\r\n    table.forEach((r) => {\r\n        if (r.length === 2) {\r\n            r.push(defaultWeek);\r\n        }\r\n    });\r\n\r\n    const matches = [];\r\n    const weeks = [...new Set(table.map((t) => t[3]))];\r\n\r\n    weeks.forEach((weekNumber) => {\r\n        console.log(`\\nRankings after week ${weekNumber}`);\r\n\r\n        const records = table.filter((r) => r[3] === weekNumber);\r\n\r\n        // Add new players dynamically\r\n        records.forEach((r) => {\r\n            const [player1Name, player2Name] = [r[0], r[1]];\r\n            if (!players.some((p) => p.name === player1Name)) {\r\n                players.push({ name: player1Name, glicko: glicko.makePlayer() });\r\n            }\r\n            if (!players.some((p) => p.name === player2Name)) {\r\n                players.push({ name: player2Name, glicko: glicko.makePlayer() });\r\n            }\r\n        });\r\n\r\n        // Create matches\r\n        records.forEach((r) => {\r\n            let newMatch = [getPlayer(r[0]), getPlayer(r[1]), getScore(r[2])];\r\n            matches.push(newMatch);\r\n        });\r\n\r\n        glicko.updateRatings(matches);\r\n        showRankings();\r\n    });\r\n}\r\n\r\nfunction getScore(scoreText) {\r\n    switch (scoreText) {\r\n        case \"w\":\r\n            return 1;\r\n        case \"l\":\r\n            return 0;\r\n        case \"d\":\r\n            return 0.5;\r\n        default:\r\n            throw new Error(\"Invalid score text\");\r\n    }\r\n}\r\n\r\nfunction addEventListeners() { \r\n    addInstructionToggleListener();\r\n    addFormListener();\r\n}\r\n\r\nfunction addInstructionToggleListener() {\r\n    document.getElementById(\"toggleInstructions\").addEventListener(\"click\", function () {\r\n        const instructions = document.getElementById(\"instructions\");\r\n        if (instructions.style.display === \"none\") {\r\n            instructions.style.display = \"block\";\r\n            this.textContent = \"Hide Instructions\";\r\n        } else {\r\n            instructions.style.display = \"none\";\r\n            this.textContent = \"Show Instructions\";\r\n        }\r\n    });\r\n}\r\n\r\nfunction addFormListener() {\r\n    const form = document.getElementById(\"form-ingest\");\r\n    form.addEventListener(\"submit\", (event) => {\r\n        event.preventDefault();\r\n        createMatches(event);\r\n        return false;\r\n    });\r\n}\r\n"],"names":["Glicko2","require","settings","tau","rpd","rating","rd","vol","glicko","players","getPlayer","name","find","p","window","onload","e","addEventListeners","showRankings","sort","pl1","pl2","getRating","rankingsDiv","document","getElementById","innerHTML","title","createElement","textContent","appendChild","list","forEach","player","listItem","toFixed","deviation","getRd","concat","style","display","createMatches","event","preventDefault","separator","value","table","split","map","r","defaultWeek","length","push","matches","weeks","_toConsumableArray","Set","t","weekNumber","console","log","records","filter","_ref","player1Name","player2Name","some","makePlayer","newMatch","getScore","updateRatings","scoreText","Error","addInstructionToggleListener","addFormListener","addEventListener","instructions","form"],"sourceRoot":""}